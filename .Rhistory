theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "darkred", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_minimal() +
labs(x = "SNPs", y = "SNPs", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "darkred", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(x = "SNPs", y = "SNPs", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
View(calculate_ld)
View(ChiSq)
View(ld_matrix)
colnames(ld_matrix) <- SNP_ID
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "darkred", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(x = "SNPs", y = "SNPs", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
rownames(ld_matrix) <- SNP_ID
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "darkred", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(x = "SNPs", y = "SNPs", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
# Plot LD matrix as a heatmap with theme_void
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "blue", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(title = "LD Plot") +
theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right") +
annotate("text", x = rep(seq_len(ncol(ld_matrix)), each = nrow(ld_matrix)),
y = rep(seq_len(nrow(ld_matrix)), ncol(ld_matrix)),
label = c(rownames(ld_matrix), colnames(ld_matrix)),
color = "black", size = 3) +
theme(plot.title = element_text(size = 14, face = "bold", hjust = 0.5))
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "SNPs", y = "SNPs", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "Blue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "SNPs", y = "SNPs", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "blue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "SNPs", y = "SNPs", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "SNPs", y = "SNPs", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 45, vjust = 0, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 95, vjust = 1, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "navyblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "cornflowerblue", high = "orange", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "cornflowerblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "black", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "darkgrey", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
cornflowerblue
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "cornflowerblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
![data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA)]
data[!data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA)]
data[!(data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA))]
!(data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA))
data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA))
data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA)
# Cleaning the data
data_cl <- replace(data, !(data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA)), NA)
View(data_cl)
data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA)
data[!data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA)]
data[!(data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA))]
!(data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA))
# Cleaning the data
data_cl <- replace(data, !(data %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA)), NA)
View(data_cl)
# Cleaning the data
data_cl <- as.data.frame(lapply(data[-1], function(x) ifelse(!x %in% c("AA", "CC", "GG","TT", "AC", "AG", "AT", "CG", "CT", "GT", NA), NA, x)))
View(data_cl)
ld_matrix <- outer(data_cl, data_cl, Vectorize(calculate_ld))
ld_matrix[lower.tri(ld_matrix)] <- NA
colnames(ld_matrix) <- SNP_ID
rownames(ld_matrix) <- SNP_ID
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "cornflowerblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
View(ld_matrix)
Ld_mat_cl <- replace(ld_matrix, diag(ld_matrix), NA)
ggplot(data = as.data.frame(as.table(Ld_mat_cl)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "cornflowerblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "cornflowerblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
diag(ld_matrix)
diag(ld_matrix) = NA
View(ld_matrix)
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "cornflowerblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ld_matrix <- outer(data_cl, data_cl, Vectorize(calculate_ld))
ld_matrix[lower.tri(ld_matrix)] <- NA
colnames(ld_matrix) <- SNP_ID
rownames(ld_matrix) <- SNP_ID
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "cornflowerblue", high = "darkred", na.value = "transparent", guide = "legend") +
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
# Plot LD matrix as a heatmap with theme_void
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "blue", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(title = "LD Plot") +
theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right") +
annotate("text", x = rep(seq_len(ncol(ld_matrix)), each = nrow(ld_matrix)),
y = rep(seq_len(nrow(ld_matrix)), ncol(ld_matrix)),
label = c(rownames(ld_matrix), colnames(ld_matrix)),
color = "black", size = 3) +
theme(plot.title = element_text(size = 14, face = "bold", hjust = 0.5))
library(tidyverse)
library(readxl)
library(here)
# Plot LD matrix as a heatmap with theme_void
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "blue", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(title = "LD Plot") +
theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right") +
annotate("text", x = rep(seq_len(ncol(ld_matrix)), each = nrow(ld_matrix)),
y = rep(seq_len(nrow(ld_matrix)), ncol(ld_matrix)),
label = c(rownames(ld_matrix), colnames(ld_matrix)),
color = "black", size = 3) +
theme(plot.title = element_text(size = 14, face = "bold", hjust = 0.5))
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "blue", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(x = "SNPs", y = "SNPs", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "blue", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
data_cl <- as.data.frame(lapply(data[,-1], function(x) ifelse(!x %in% c("AA", "GG", "CC","TT", "AT", "AC", "AG", "CT", "CG", "GT", NA), NA, x)))
View(data_cl)
View(data)
calculate_ld <- function(snp1, snp2) {
snp1_factor <- factor(snp1)
snp2_factor <- factor(snp2)
contingency_table <- table(snp1_factor, snp2_factor)
chi_square <- chisq.test(contingency_table)$statistic
sqrt(chi_square / length(snp1))
}
ld_matrix <- outer(data[, -1], data[, -1], Vectorize(calculate_ld))
ld_matrix[lower.tri(ld_matrix)] <- NA
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
ld_matrix <- outer(data_cl, data_cl, Vectorize(calculate_ld))
ld_matrix[lower.tri(ld_matrix)] <- NA
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
# Extract rsIDs
SNP_ID <- str_extract(colnames(data)[-1], "(?<=_|\\b)rs\\d+")
rownames(ld_matrix) <- SNP_ID
ggplot(data = as.data.frame(as.table(ld_matrix)), aes(Var1, Var2, fill = Freq)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightblue", high = "darkred", na.value = "transparent", guide = "legend") +  # Set fill color for NA values to transparent
theme_void() +
labs(x = "", y = "", title = "LD Plot") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
axis.title = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 8)) +
coord_fixed() +
theme(legend.position = "right")
